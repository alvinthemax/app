<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lucky Day - Enhanced</title>

<style>
:root {
  --bg: #0f172a;
  --card: #111827;
  --accent: #22c55e;
  --warn: #f59e0b;
  --danger: #ef4444;
  --text: #e5e7eb;
  --selected-scale: 2.5;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: radial-gradient(circle at top, #1e293b, var(--bg));
  color: var(--text);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  padding: 20px;
}

/* ================= CONTAINER ================= */
.container {
  width: 100%;
  max-width: 420px;
  padding: 20px;
  text-align: center;
}

h1 {
  font-size: 1.6rem;
  margin-bottom: 6px;
}

.subtitle {
  font-size: 0.95rem;
  opacity: 0.8;
  margin-bottom: 24px;
}

/* ================= CARDS GRID ================= */
.cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 14px;
}

/* ================= CARD ================= */
.card {
  background: linear-gradient(145deg, #0b1220, var(--card));
  border-radius: 16px;
  padding: 28px 10px;
  min-height: 120px;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  box-shadow: 0 10px 25px rgba(0,0,0,0.4);
  transition: transform 0.35s ease, box-shadow 0.35s ease;
  position: relative;
  overflow: hidden;
}

.card:hover {
  transform: translateY(-6px) scale(1.04);
  box-shadow: 0 20px 40px rgba(0,0,0,0.6);
}

.card span {
  font-size: 2rem;
  transition: opacity 0.4s ease, transform 0.4s ease;
}

/* ================= RESULT TEXT ================= */
.card .result-text {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  text-align: center;
  line-height: 1.3;
  font-weight: 700;
  font-size: clamp(1.1rem, 4vw, 1.4rem);
  word-break: break-word;
  opacity: 0;
  transform: scale(0.85);
  transition: opacity 0.6s ease, transform 0.6s ease;
}

/* ================= SELECTED CARD (FIXED VERSION) ================= */
.selected-card-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1000;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

.selected-card {
  position: absolute;
  top: 50%;
  left: 50%;
  width: min(80vw, 360px);
  min-height: 200px;
  background: linear-gradient(145deg, #0b1220, var(--card));
  border-radius: 16px;
  padding: 28px 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  box-shadow: 0 40px 80px rgba(0,0,0,0.8);
  transform: translate(-50%, -50%);
  z-index: 1001;
  pointer-events: none;
  overflow: hidden;
}

.selected-card span {
  font-size: 2.5rem;
  transition: opacity 0.4s ease, transform 0.4s ease;
}

.selected-card .result-text {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
  text-align: center;
  line-height: 1.4;
  font-weight: 700;
  font-size: clamp(1.2rem, 5vw, 1.6rem);
  word-break: break-word;
  opacity: 0;
  transform: scale(0.85);
}

/* ================= ANIMATIONS ================= */
@keyframes scaleToCenter {
  0% {
    transform: translate(-50%, -50%) scale(0.3);
    opacity: 0.7;
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
}

@keyframes flipIn {
  0% {
    transform: translate(-50%, -50%) rotateY(0) scale(1);
  }
  50% {
    transform: translate(-50%, -50%) rotateY(180deg) scale(1);
  }
  100% {
    transform: translate(-50%, -50%) rotateY(360deg) scale(1);
  }
}

@keyframes fadeInResult {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes pulse {
  0% {
    transform: translate(-50%, -50%) scale(1);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.05);
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
  }
}

/* ================= RESET BUTTON ================= */
.reset-btn {
  margin-top: 30px;
  padding: 12px 24px;
  font-size: 1rem;
  font-weight: 600;
  background: linear-gradient(145deg, #1e40af, #3b82f6);
  color: white;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
}

.reset-btn.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: all;
}

.reset-btn:hover {
  background: linear-gradient(145deg, #1e3a8a, #2563eb);
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
}

/* ================= OVERLAY ================= */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(15, 23, 42, 0.9);
  backdrop-filter: blur(5px);
  z-index: 999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.6s ease;
}

.overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 480px) {
  .selected-card {
    width: 88vw;
    min-height: 180px;
  }
  
  @keyframes pulse {
    0% {
      transform: translate(-50%, -50%) scale(1);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.05);
    }
    100% {
      transform: translate(-50%, -50%) scale(1);
    }
  }
}

@media (max-width: 360px) {
  h1 {
    font-size: 1.4rem;
  }
  
  .card span {
    font-size: 1.6rem;
  }
  
  .selected-card {
    min-height: 160px;
  }
}
</style>
</head>

<body>
<div class="container" id="container">
  <h1>Choose Your Card</h1>
  <div class="subtitle">Only one chance today</div>

  <div class="cards" id="cardsContainer">
    <div class="card" data-card="1">
      <span>ðŸ‚ </span>
      <div class="result-text"></div>
    </div>
    <div class="card" data-card="2">
      <span>ðŸ‚ </span>
      <div class="result-text"></div>
    </div>
    <div class="card" data-card="3">
      <span>ðŸ‚ </span>
      <div class="result-text"></div>
    </div>
  </div>

  <button class="reset-btn" id="resetBtn">Play Again</button>
</div>

<!-- Overlay untuk blur background -->
<div class="overlay" id="overlay"></div>

<!-- Container untuk kartu yang dipilih -->
<div class="selected-card-container" id="selectedCardContainer">
  <div class="selected-card" id="selectedCard">
    <span>ðŸ‚ </span>
    <div class="result-text" id="selectedResultText"></div>
  </div>
</div>

<script>
class LuckyDayGame {
  constructor() {
    this.selected = false;
    this.animationInProgress = false;
    this.cards = document.querySelectorAll('.card');
    this.container = document.getElementById('container');
    this.cardsContainer = document.getElementById('cardsContainer');
    this.resetBtn = document.getElementById('resetBtn');
    this.overlay = document.getElementById('overlay');
    this.selectedCardContainer = document.getElementById('selectedCardContainer');
    this.selectedCard = document.getElementById('selectedCard');
    this.selectedResultText = document.getElementById('selectedResultText');
    
    this.init();
  }
  
  init() {
    this.cards.forEach(card => {
      card.addEventListener('click', (e) => this.handleCardClick(e, card));
    });
    
    this.resetBtn.addEventListener('click', () => this.resetGame());
    
    // Sembunyikan container kartu pilihan di awal
    this.selectedCardContainer.style.display = 'none';
  }
  
  getRandomOutcome() {
    if (window.crypto && crypto.randomUUID) {
      const uuid = crypto.randomUUID();
      const hash = Array.from(uuid).reduce((acc, char) => {
        return acc + char.charCodeAt(0);
      }, 0);
      return hash % 3;
    }
    
    if (window.crypto && crypto.getRandomValues) {
      const array = new Uint32Array(1);
      crypto.getRandomValues(array);
      return array[0] % 3;
    }
    
    const extraEntropy = Date.now() % 1000;
    return Math.floor((Math.random() * 1000 + extraEntropy) % 3);
  }
  
  async handleCardClick(event, card) {
    if (this.selected || this.animationInProgress) return;
    
    this.animationInProgress = true;
    this.selected = true;
    
    // Ambil posisi kartu yang diklik untuk animasi awal
    const rect = card.getBoundingClientRect();
    const startX = rect.left + rect.width / 2;
    const startY = rect.top + rect.height / 2;
    
    // Sembunyikan kartu asli yang diklik dengan animasi
    card.style.opacity = '0';
    card.style.transform = 'scale(0.8)';
    card.style.pointerEvents = 'none';
    
    // Nonaktifkan semua kartu lain
    this.cards.forEach(c => {
      if (c !== card) {
        c.style.opacity = '0.3';
        c.style.pointerEvents = 'none';
      }
    });
    
    // Tampilkan overlay
    this.overlay.classList.add('active');
    
    // Siapkan kartu pilihan
    this.selectedCardContainer.style.display = 'flex';
    this.selectedCard.style.opacity = '0';
    this.selectedCard.style.transform = `translate(${startX}px, ${startY}px) scale(0.3)`;
    
    // Reset teks hasil
    this.selectedResultText.textContent = '';
    this.selectedResultText.style.opacity = '0';
    
    // Reset simbol kartu
    const cardSymbol = this.selectedCard.querySelector('span');
    cardSymbol.style.opacity = '1';
    cardSymbol.style.transform = 'scale(1)';
    
    // Reset background kartu
    this.selectedCard.style.background = 'linear-gradient(145deg, #0b1220, #111827)';
    this.selectedCard.style.color = '#e5e7eb';
    this.selectedCard.style.boxShadow = '0 10px 25px rgba(0,0,0,0.4)';
    
    // Tampilkan kartu pilihan dengan animasi ke tengah
    await this.sleep(50);
    
    this.selectedCard.style.transition = 'transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.8s ease';
    this.selectedCard.style.opacity = '1';
    this.selectedCard.style.transform = 'translate(-50%, -50%) scale(1)';
    
    // Tunggu sampai kartu sampai di tengah
    await this.sleep(800);
    
    // Generate random outcome
    const outcome = this.getRandomOutcome();
    
    // Apply result based on outcome
    await this.applyResult(outcome);
    
    // Tunggu animasi selesai
    await this.sleep(1200);
    
    // Tampilkan tombol reset
    this.resetBtn.classList.add('show');
    
    this.animationInProgress = false;
    
    console.log('Outcome:', outcome);
  }
  
  async applyResult(outcome) {
    let resultText = "";
    
    // Apply flip animation
    this.selectedCard.style.transition = 'none';
    this.selectedCard.style.animation = 'flipIn 1.2s ease forwards';
    
    // Wait for flip animation halfway
    await this.sleep(600);
    
    // Hide card symbol
    const cardSymbol = this.selectedCard.querySelector('span');
    cardSymbol.style.opacity = '0';
    cardSymbol.style.transform = 'scale(0)';
    
    // Set result based on outcome
    switch(outcome) {
      case 0: // Lucky
        resultText = "ðŸŽ‰ Today Is Lucky Day!";
        this.selectedCard.style.background = "linear-gradient(145deg, #052e16, #14532d, #22c55e)";
        this.selectedCard.style.color = "#bbf7d0";
        break;
      case 1: // Sleep
        resultText = "ðŸ˜´ Get Some Sleep, Or Try To Relax";
        this.selectedCard.style.background = "linear-gradient(145deg, #451a03, #92400e, #f59e0b)";
        this.selectedCard.style.color = "#fde68a";
        break;
      case 2: // Keep working
        resultText = "ðŸ’¼ Better Keep Working";
        this.selectedCard.style.background = "linear-gradient(145deg, #450a0a, #991b1b, #ef4444)";
        this.selectedCard.style.color = "#fecaca";
        break;
    }
    
    // Set result text
    this.selectedResultText.textContent = resultText;
    
    // Wait for flip animation to complete
    await this.sleep(600);
    
    // Show result text with animation
    this.selectedResultText.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
    this.selectedResultText.style.opacity = '1';
    this.selectedResultText.style.transform = 'scale(1)';
    
    // Apply pulse animation
    setTimeout(() => {
      this.selectedCard.style.animation = 'pulse 2s infinite';
      this.selectedCard.style.boxShadow = '0 0 60px rgba(255, 255, 255, 0.2), 0 40px 80px rgba(0, 0, 0, 0.8)';
    }, 300);
  }
  
  resetGame() {
    // Sembunyikan tombol reset
    this.resetBtn.classList.remove('show');
    
    // Sembunyikan overlay
    this.overlay.classList.remove('active');
    
    // Reset kartu pilihan
    this.selectedCard.style.animation = '';
    this.selectedCard.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
    this.selectedCard.style.opacity = '0';
    this.selectedCard.style.transform = 'translate(-50%, -50%) scale(0.5)';
    
    // Reset teks hasil
    this.selectedResultText.style.opacity = '0';
    this.selectedResultText.style.transform = 'scale(0.85)';
    this.selectedResultText.textContent = '';
    
    // Sembunyikan container kartu pilihan setelah animasi
    setTimeout(() => {
      this.selectedCardContainer.style.display = 'none';
    }, 500);
    
    // Reset semua kartu asli
    this.cards.forEach(card => {
      card.style.opacity = '1';
      card.style.transform = '';
      card.style.pointerEvents = 'auto';
    });
    
    // Reset state
    setTimeout(() => {
      this.selected = false;
      this.animationInProgress = false;
    }, 300);
  }
  
  sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

// Initialize the game
const game = new LuckyDayGame();
</script>
</body>
</html>